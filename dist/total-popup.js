class TotalPopupWindow{constructor(t=null){this.transform={x:null,y:null,w:500,h:500,minWidth:250,minHeight:250,maxHeight:1500,maxWidth:1500,margin:{top:15,bottom:15,left:15,right:15},borderWidth:4,offset:{x1:0,y1:0,x2:0,y2:0,start:function(t,i){this.x1=this.x2=t,this.y1=this.y2=i},update:function(t,i){this.x2=t,this.y2=i},get:function(){const t=[this.x2-this.x1,this.y2-this.y1];return this.x1=this.x2,this.y1=this.y2,t}},resizable:!0},assignArgs(this.transform,t),this.target=null,this.fullscreen=!1,this.main=document.createElement("div"),this.main.style.position="absolute",this.main.style.display="grid",this.main.style.gridTemplateColumns=`${this.transform.borderWidth}px auto ${this.transform.borderWidth}px`,this.main.style.gridTemplateRows=`${this.transform.borderWidth}px auto ${this.transform.borderWidth}px`,this.main.classList.add("total-popup-window"),this.bottomRight=new TotalPopupBorder("bottom-right",this.transform.resizable),this.bottomLeft=new TotalPopupBorder("bottom-left",this.transform.resizable),this.topLeft=new TotalPopupBorder("top-left",this.transform.resizable),this.topRight=new TotalPopupBorder("top-right",this.transform.resizable),this.top=new TotalPopupBorder("top",this.transform.resizable),this.bottom=new TotalPopupBorder("bottom",this.transform.resizable),this.left=new TotalPopupBorder("left",this.transform.resizable),this.right=new TotalPopupBorder("right",this.transform.resizable),this.middle=document.createElement("div"),this.middle.style.display="flex",this.middle.style.flexDirection="column",this.middle.classList.add("middle");const i={side:"right",icons:{minimize:"&#11451;",maximize:"&#9634;",demaximize:"&#129196;",close:"&#215;",locked:"&#129181;"},callback:{onMinimize:null,onMaximize:null,onClose:null}};assignArgs(i,t),this.controls=null,(i.icons.minimize||i.icons.maximize||i.icons.demaximize||i.icons.close||i.icons.locked)&&(this.controls=new TotalPopupControl({container:this.middle,parent:this,...i})),this.inner=new TotalPopupInner({parent:this,content:"content"in t?t.content:null}),this.middle.append(this.inner.main),this.content=t.content,this.main.append(this.topLeft.main),this.main.append(this.top.main),this.main.append(this.topRight.main),this.main.append(this.left.main),this.main.append(this.middle),this.main.append(this.right.main),this.main.append(this.bottomLeft.main),this.main.append(this.bottom.main),this.main.append(this.bottomRight.main),this.container=t.container||document.querySelector("body"),this.container.append(this.main),null==this.transform.x&&null==this.transform.y&&(this.transform.x=document.body.clientWidth/2-this.transform.w/2,this.transform.y=document.body.clientHeight/2-this.transform.h/2),this.update(),this.startDragEvent=this.startDrag.bind(this),this.dragEvent=this.drag.bind(this),this.endDragEvent=this.endDrag.bind(this),this.main.addEventListener("pointerdown",this.startDragEvent),document.addEventListener("mouseout",(t=>{const i=t.relatedTarget||t.toElement;i&&"HTML"!=i.nodeName||this.endDrag()}))}startDrag(t){this.fullscreen||(this.target=this.getTarget(t.composedPath(),["border","content","toolbar","total-popup-window"]),null!=this.target&&(this.main.parentNode.append(this.main),this.container.addEventListener("pointermove",this.dragEvent),this.container.addEventListener("pointerup",this.endDragEvent),this.transform.offset.start(t.x,t.y)))}drag(t){null!=this.target&&(this.transform.offset.update(t.x,t.y),this.updatePosition(this.target),this.update())}endDrag(){this.container.removeEventListener("pointermove",this.dragEvent),this.container.removeEventListener("pointerup",this.endDragEvent),this.target=null}getTarget(t,i){for(const s of t)if("DIV"==s.nodeName&&i.some((t=>s.classList.contains(t))))return s;return null}updatePosition(t){const[i,s]=this.transform.offset.get();t.classList.contains("bottom-right")&&this.transform.resizable?(this.transform.h+s>=this.transform.minHeight&&this.transform.h+s<=this.transform.maxHeight&&(this.transform.h+=s),this.transform.w+i>=this.transform.minWidth&&this.transform.w+i<=this.transform.maxWidth&&(this.transform.w+=i)):t.classList.contains("bottom-left")&&this.transform.resizable?(this.transform.h+s>=this.transform.minHeight&&this.transform.h+s<=this.transform.maxHeight&&(this.transform.h+=s),this.transform.w-i>=this.transform.minWidth&&this.transform.w-i<=this.transform.maxWidth&&(this.transform.x+=i,this.transform.w-=i)):t.classList.contains("top-left")&&this.transform.resizable?(this.transform.h-s>=this.transform.minHeight&&this.transform.h-s<=this.transform.maxHeight&&(this.transform.y+=s,this.transform.h-=s),this.transform.w-i>=this.transform.minWidth&&this.transform.w-i<=this.transform.maxWidth&&(this.transform.x+=i,this.transform.w-=i)):t.classList.contains("top-right")&&this.transform.resizable?(this.transform.h-s>=this.transform.minHeight&&this.transform.h-s<=this.transform.maxHeight&&(this.transform.y+=s,this.transform.h-=s),this.transform.w+i>=this.transform.minWidth&&this.transform.w+i<=this.transform.maxWidth&&(this.transform.w+=i)):t.classList.contains("top")&&this.transform.resizable?this.transform.h-s>=this.transform.minHeight&&this.transform.h-s<=this.transform.maxHeight&&(this.transform.y+=s,this.transform.h-=s):t.classList.contains("bottom")&&this.transform.resizable?this.transform.h+s>=this.transform.minHeight&&this.transform.h+s<=this.transform.maxHeight&&(this.transform.h+=s):t.classList.contains("left")&&this.transform.resizable?this.transform.w-i>=this.transform.minWidth&&this.transform.w-i<=this.transform.maxWidth&&(this.transform.x+=i,this.transform.w-=i):t.classList.contains("right")&&this.transform.resizable?this.transform.w+i>=this.transform.minWidth&&this.transform.w+i<=this.transform.maxWidth&&(this.transform.w+=i):(t.classList.contains("total-popup-window")||t.classList.contains("content")||t.classList.contains("toolbar"))&&(this.transform.x+=i,this.transform.y+=s)}update(){this.main.style.transform=`translate(${this.transform.x}px, ${this.transform.y}px)`,this.main.style.width=Math.min(Math.max(this.transform.w,this.transform.minWidth),Math.min(this.transform.w,this.transform.maxWidth))+"px",this.main.style.height=Math.min(Math.max(this.transform.h,this.transform.minHeight),Math.min(this.transform.h,this.transform.maxHeight))+"px"}hide(){this.container.removeEventListener("pointerdown",this.startDragEvent),this.container.removeEventListener("pointermove",this.dragEvent),this.container.removeEventListener("pointerup",this.endDragEvent),this.main.style.display="none"}show(){this.container.addEventListener("pointerdown",this.startDragEvent),this.container.addEventListener("pointermove",this.dragEvent),this.container.addEventListener("pointerup",this.endDragEvent),this.main.style.display="grid"}maximize(){this.fullscreen?(this.fullscreen=!1,this.update()):(this.fullscreen=!0,this.main.style.transform=`translate(0px, ${this.transform.margin.top}px)`,this.main.style.width=document.body.clientWidth+"px",this.main.style.height=document.body.clientHeight-this.transform.margin.top+"px")}close(){this.inner.del(),this.main.remove()}fit(){const t=document.body.clientWidth-(this.transform.margin.right+this.transform.margin.left),i=document.body.clientHeight-(this.transform.margin.bottom+this.transform.margin.top);this.transform.maxWidth>t?(this.transform.x=this.transform.margin.right,this.transform.w=t):(this.transform.x=document.body.clientWidth/2-this.transform.maxWidth/2,this.transform.w=this.transform.maxWidth),this.transform.maxHeight>i?(this.transform.y=this.transform.margin.top,this.transform.h=i):(this.transform.y=document.body.clientHeight/2-this.transform.maxHeight/2,this.transform.h=this.transform.maxHeight),this.update()}}class TotalPopupInner{constructor(t){this.parent=t.parent,this.main=document.createElement("div"),"content"in t&&null!=t.content&&this.add(t.content),this.main.classList.add("content"),this.content=null}add(t){"string"==typeof t?this.main.innerHTML=t:"HTMLElement"==Object.getPrototypeOf(t.constructor).name?this.main.append(t):"object"==typeof t&&(this.content=t,this.main.append(t.main),"parent"in t&&(t.parent=this.parent))}del(){this.content&&delete this.content}}class TotalPopupBorder{constructor(t,i=!1){this.main=document.createElement("div"),this.main.classList.add("border"),this.main.classList.add(t),i&&this.main.classList.add("resize")}}class TotalPopupControl{constructor(t){this.parent=t.parent,this.icons={minimize:null,maximize:null,demaximize:null,close:null,locked:null},assignArgs(this.icons,t.icons),this.callback={onMinimize:null,onMaximize:null,onClose:null},assignArgs(this.callback,t.callback),this.main=document.createElement("div"),this.main.style.display="flex",this.main.classList.add("toolbar"),"left"==t.side?(this.main.style.display="flex",this.icons.close&&(this.close=document.createElement("div"),this.main.append(this.close)),this.icons.minimize&&(this.minimize=document.createElement("div"),this.main.append(this.minimize)),this.icons.maximize&&(this.maximize=document.createElement("div"),this.main.append(this.maximize))):"right"==t.side&&(this.main.style.flexDirection="row-reverse",this.icons.close&&(this.close=document.createElement("div"),this.main.append(this.close)),this.icons.maximize&&(this.maximize=document.createElement("div"),this.main.append(this.maximize)),this.icons.minimize&&(this.minimize=document.createElement("div"),this.main.append(this.minimize))),this.icons.close&&(this.close.innerHTML=t.icons.close,this.close.classList.add("close"),this.close.classList.add("button")),this.icons.minimize&&(this.minimize.innerHTML=t.icons.minimize,this.minimize.classList.add("minimize"),this.minimize.classList.add("button")),this.icons.maximize&&(this.maximize.innerHTML=t.icons.maximize,this.maximize.classList.add("maximize"),this.maximize.classList.add("button")),t.container.append(this.main),this.closeLocked=!1,this.icons.close&&this.close.addEventListener("pointerup",this.closeWin.bind(this)),this.icons.minimize&&this.minimize.addEventListener("pointerup",this.minimizeWin.bind(this)),this.icons.maximize&&this.maximize.addEventListener("pointerup",this.maximizeWin.bind(this))}closeLock(){this.closeLocked=!0,this.close.innerHTML=this.icons.locked}closeUnlock(){this.closeLocked=!1,this.close.innerHTML=this.icons.close}closeWin(){this.closeLocked||this.parent.close(),this.callback.onClose&&this.callback.onClose()}maximizeWin(){this.maximize.innerHTML==this.icons.maximize?this.maximize.innerHTML=this.icons.demaximize:this.maximize.innerHTML=this.icons.maximize,this.parent.maximize(),this.callback.onMaximize&&this.callback.onMaximize()}minimizeWin(){this.parent.hide(),this.callback.onMinimize&&this.callback.onMinimize()}}function assignArgs(t,i){if(Object(t)!==t||Object(i)!==i)return i;for(const s in i)s in t&&(t[s]=assignArgs(t[s],i[s]));return t}
class TotalTabs{constructor(t={}){const{width:s=200,height:i=45,newTab:a=null}=t;this.parent=null,this.id=crypto.randomUUID(),this.main=document.createElement("div"),this.main.classList.add("tabs"),this.main.style.position="relative",this.tabbar=document.createElement("div"),this.tabbar.classList.add("tabbar"),this.tabbar.id=this.id,this.tabbar.style.height=i+"px",this.content=document.createElement("div"),this.content.style.width="100%",this.content.style.height="100%",this.content.classList.add("content"),this.width=s,"newTab"in t&&this.assignTab(t.newTab),this.main.append(this.tabbar),this.main.append(this.content),this.list=[],this.dragTab=null,this.canSend=!1,this.callback={onDock:null,onUndock:null,onZeroTabs:null},assignArgs(this.callback,t.callback),this.transform={dock:!0,undock:!0,offset:{startPos:{x:0,y:0},x1:0,y1:0,x2:0,y2:0,start:function(t,s){this.x1=this.x2=this.startPos.x=t,this.y1=this.y2=this.startPos.y=s},update:function(t,s){this.x2=t,this.y2=s},get:function(){const t=[this.x2-this.x1,this.y2-this.y1];return this.x1=this.x2,this.y1=this.y2,t}}},this.startDragEvent=this.startDrag.bind(this),this.dragEvent=this.drag.bind(this),this.endDragEvent=this.endDrag.bind(this),this.main.addEventListener("pointerdown",this.startDragEvent)}addTab(t,s){const i=new TotalTab({name:t,content:s,width:this.width,tabs:this,icon:'<i class="fa-solid fa-xmark"></i>'});this.list.push(i),this.tabbar.append(i.tab),this.content.append(i.content.content);for(const t of this.list)t.hideContent();i.showContent()}assignTab(t){t.tabs=this,this.list.push(t),this.tabbar.append(t.tab),this.content.append(t.content.content),this.sortTabs();for(const t of this.list)t.hideContent();t.showContent()}hideTabsContent(){for(const t of this.list)t.hideContent()}removeTab(t){arrayRemove(this.list,t),this.sortTabs(),this.list.length>1?this.enableFirstTab():null!=this.callback.onZeroTabs&&this.callback.onZeroTabs(this.id)}getActiveTab(){for(const t of this.list)if(t.tab.classList.contains("active"))return t;return null}startDrag(t){t.stopPropagation(),t.target.classList.contains("active")&&(this.transform.offset.start(t.x,t.y),this.dragTab=this.getActiveTab(),this.dragTab.tab.classList.remove("animated"),this.tabbar.append(this.dragTab.tab),this.canSend=!0,document.body.addEventListener("pointermove",this.dragEvent),document.body.addEventListener("pointerup",this.endDragEvent))}drag(t){if(t.stopPropagation(),null!=this.dragTab){this.transform.offset.update(t.x,t.y);const s=this.transform.offset.get()[0];if(this.dragTab.transform.x+s>=0&&this.dragTab.transform.x+this.width+s<this.tabbar.offsetWidth&&(this.dragTab.transform.x+=s,this.dragTab.update(),Math.abs(this.transform.offset.startPos.x-this.transform.offset.x1)>this.width-10))if(this.transform.offset.startPos.x-this.transform.offset.x1>0){const t=this.list[this.list.indexOf(this.dragTab)-1];if(null!=t){t.transform.x+=this.width,t.update(),this.transform.offset.startPos.x=this.transform.offset.x1;const s=this.list[this.list.indexOf(this.dragTab)];this.list[this.list.indexOf(this.dragTab)]=this.list[this.list.indexOf(t)],this.list[this.list.indexOf(t)]=s}}else if(this.transform.offset.startPos.x-this.transform.offset.x1<0&&this.list.indexOf(this.dragTab)<this.list.length-1){const t=this.list[this.list.indexOf(this.dragTab)+1];if(null!=t){t.transform.x-=this.width,t.update(),this.transform.offset.startPos.x=this.transform.offset.x1;const s=this.list[this.list.indexOf(t)];this.list[this.list.indexOf(t)]=this.list[this.list.indexOf(this.dragTab)],this.list[this.list.indexOf(this.dragTab)]=s}}this.transform.undock&&this.canSend&&this.list.length>1&&(Math.abs(this.transform.offset.startPos.y-this.transform.offset.y1)>100||Math.abs(this.transform.offset.startPos.x-this.transform.offset.x1)>this.width+30)&&(this.callback.onUndock&&arrayRemove(this.callback.onUndock,this.dragTab),this.list.remove(this.dragTab),this.dragTab.transform.x=0,this.dragTab.update(),this.dragTab=null,this.sortTabs(),this.enableFirstTab(),this.canSend=!1,document.body.removeEventListener("pointermove",this.dragEvent),document.body.removeEventListener("pointerup",this.endDragEvent))}}endDrag(t){t.stopPropagation(),document.body.removeEventListener("pointermove",this.dragEvent),document.body.removeEventListener("pointerup",this.endDragEvent);for(const s of t.composedPath())if("DIV"==s.nodeName&&s.classList.contains("tabbar")&&s.id!=this.tabbar.id&&this.callback.onDock)return this.callback.onDock(this.dragTab,s.id),void(this.dragTab=null);null!=this.dragTab&&this.list.includes(this.dragTab)&&(this.dragTab.tab.classList.add("animated"),this.dragTab.tab.parentNode.append(this.dragTab.tab),this.dragTab.transform.x=this.width*this.list.indexOf(this.dragTab),this.dragTab.update(),this.dragTab=null)}sortTabs(){for(const t of this.list)t.transform.x=this.width*this.list.indexOf(t),t.update()}enableFirstTab(){this.list[0].showContent()}}class TotalTab{constructor(t){this.tabs=t.tabs,this.transform={x:t.width*this.tabs.list.length,y:0,width:t.width,center:t.width/2},this.tab=document.createElement("div"),this.tab.innerHTML=t.name,this.tab.classList.add("tab"),this.tab.classList.add("animated"),this.tab.style.position="absolute",this.tab.style.left=this.transform.x+"px",this.tab.style.top="0px","number"==typeof t.width?this.tab.style.width="calc("+t.width+"px - 2px)":"string"==typeof t.width&&(this.tab.style.width=t.width),this.tab.style.height="calc(45px - 2px)",this.tab.style.display="flex",this.close=document.createElement("div"),this.close.innerHTML=t.icon,this.close.classList.add("close"),"left"==t.side?this.tab.insertBefore(this.close,this.tab.firstChild):this.tab.append(this.close),this.content=new TotalTabPage(t.content),this.tab.addEventListener("pointerdown",this.showContent.bind(this)),this.close.addEventListener("pointerup",this.closeTab.bind(this))}closeTab(t){for(const s of t.composedPath())if(s.classList.contains("close")){this.tabs.removeTab(this),this.tab.remove(),this.content.content.remove();break}}showContent(){this.tabs.hideTabsContent(),this.tab.classList.add("active"),this.content.show()}hideContent(){this.content.hide(),this.tab.classList.contains("active")&&this.tab.classList.remove("active")}update(){this.tab.style.left=this.transform.x+"px"}}class TotalTabPage{constructor(t){this.content=document.createElement("div"),this.content.classList.add("page"),this.content.innerHTML=t}show(){this.content.style.display="flex"}hide(){this.content.style.display="none"}}